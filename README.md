# ExcuseMakerApi
Excuse Maker API is a .NET Core Web API that allows users to manage and retrieve excuses based on different categories. It includes circuit breaker, retry, and timeout policies to enhance resilience in case of external service failures.

## Table of Contents

- [Prerequisites](#prerequisites)
- [Building the Application](#building-the-application)
- [Running the Application](#running-the-application)
- [Testing the Application](#testing-the-application)
- [Setting up the Database](#setting-up-the-database)
- [Clean Coding and Resilience Principles](#clean-coding-and-resilience-principles)

## Prerequisites

Check whether you have the following installed on your machine:

- [.NET SDK](https://dotnet.microsoft.com/download)
- [Entity Framework Core](https://docs.microsoft.com/en-us/ef/core/get-started/install)

## Building the Application

Open the command line and navigate to the root folder of the application. Run the following command to build the solution:

```bash
dotnet build
```

## Running the Application

To run the application, use this command:

```bash
dotnet run --project ExcuseMakerApi
```

The API is accessible at `http://localhost:5000`.

## Testing the Application

The application includes various API endpoints for managing excuses.
The API can be interacted with by calling the URL above and interacting with the Web GUI generated by Swagger.

Here are some API endpoints:

- **Create Excuse:**
    - **Endpoint:** `POST /api`
    - **Payload:** Excuse object
    - **Response:** Created or BadRequest

- **Get Excuse by ID:**
    - **Endpoint:** `GET /api/GetById?id={excuseId}`
    - **Response:** Excuse object or NotFound

- **Get Excuses by Category:**
    - **Endpoint:** `GET /api/GetByCategory?category={excuseCategory}`
    - **Response:** List of Excuse objects or NotFound

- **Get All Excuses:**
    - **Endpoint:** `GET /api/GetAllExcuses`
    - **Response:** List of Excuse objects or NotFound

- **Delete Excuse by ID:**
    - **Endpoint:** `DELETE /api?id={excuseId}`
    - **Response:** OK or NotFound

- **Update Excuse:**
    - **Endpoint:** `PUT /api`
    - **Payload:** Excuse object
    - **Response:** OK or NotFound

- **Get Random Excuse:**
    - **Endpoint:** `GET /api/GetRandomExcuse?category={excuseCategory}`
    - **Response:** Excuse text or NotFound

## Setting up the Database

The application uses Entity Framework Core for database operations. Before the application is started, the Database has to be manually created with the name `Excuses`.
The database is automatically migrated when the application is started.

Ensure that your database connection string is correctly configured in the `appsettings.json` file in the `ConnectionStrings` section.

```json
"ConnectionStrings": {
  "ExcuseDatabase": "your_database_connection_string"
}
```

After configuring the connection string, run the following command to apply the database migrations:

```bash
dotnet ef database update --project Persistance
```

This will create the necessary tables and seed some initial data.

## Clean Coding and Resilience Principles

### Clean Coding Principles:

1. **SOLID Principles:**
  - The code follows SOLID principles, by using a modular and maintainable design.
  - Every class and method has a single responsibility which makes the code more cohesive.

2. **Descriptive Naming:**
  - Descriptive names are used for classes, methods, and variables.
  - This enhances code readability and reduces the need for comments to explain the code.

3. **Dependency Injection:**
  - Dependencies are injected through the constructor, promoting loose coupling.
  - The use of dependency injection makes testing and replacing components easier.

4. **Exception Handling:**
  - Proper exception handling is implemented, including error messages and logging.
  - The use of custom exceptions enhances clarity and helps distinguishing between various failure scenarios.

5. **Logging:**
  - Logging is integrated using Microsoft.Extensions.Logging.
  - Log messages are descriptive and help with troubleshooting and debugging.

### Resilience Principles:

1. **Circuit Breaker Pattern:**
  - The API includes a circuit breaker pattern using the `Polly` library to handle transient faults.
  - The circuit breaker helps prevent repeated failures from overloading the system and allows it to recover before attempting requests again.

2. **Retry Policy:**
  - A retry policy is implemented using `Polly` for certain HTTP requests.
  - It introduces an exponential backoff strategy, helping to handle transient failures and retries requests in case of failures.

3. **Timeout Policy:**
  - A timeout policy is applied to certain operations, preventing requests from waiting indefinitely.
  - This ensures that if an operation takes too long, it is canceled, and an appropriate response is provided.

4. **Exception Handling in Resilience Strategies:**
  - Resilience strategies (retry, circuit breaker) include specific exception handling.
  - This ensures that the application can distinguish between different types of exceptions and respond accordingly.